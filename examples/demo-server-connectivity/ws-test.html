<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
    // Load the Javascript library for our board game framework
    <script type="text/javascript" src="../../boardgameframework.js"></script>
    <script>  
        // Application-specific code
        window.addEventListener("load", function(evt) {
            // Elements of our page
            var output = document.getElementById("output");
            var words = document.getElementById("words");
            var truth = document.getElementById("truth");
            var wholenumber = document.getElementById("wholenumber");

            // Functions specific to our simple demo application

            // Add content to the output div, just below the header
            var print = function(message) {
                var d = document.createElement("p");
                d.textContent = message;
                second = output.childNodes.item(1);
                output.insertBefore(d, second);
            };

            // This is what we'll do when the framework sends data to our app
            boardgameframework.toapp = function(env) {
                print(JSON.stringify(env));
            }

            // Event for our application
            document.getElementById("open").onclick = function(evt) {
                boardgameframework.act({
                    instruction: "Open",
                    url: "ws://localhost:8080/g/sample-game"
                });
                return false;
            };
            document.getElementById("send").onclick = function(evt) {
                msg = {
                    words: words.value,
                    truth: truth.checked,
                    wholenumber: parseInt(wholenumber.value)

                };
                boardgameframework.act({instruction: "Send", body: msg});
                return false;
            };
            document.getElementById("close").onclick = function(evt) {
                boardgameframework.act({instruction: "Close" });
                return false;
            };
        });
    </script>
    </head>
    <body>
        <table>
            <tr><td valign="top" width="50%">
                <p>Click "Open" to connect to the server.
                "Send" to send a message to the server.
                "Close" to close the connection. 
                You can change the message and send multiple times.
                </p>
                <p>This code assumes the server is at
                http://localhost:8080</p>
                <form>
                    <button id="open">Open</button>
                    <button id="close">Close</button>
                    <p>
                    {<br/>
                    Words:
                    <input id="words" type="text" value="Hello world!"><br/>
                    Truth
                    <input id="truth" type="checkbox" value="true"><br/>
                    Whole number:
                    <input id="wholenumber" type="text" value="27"><br/>
                    }
                    </p>
                    <button id="send">Send</button>
                </form>
            </td><td valign="top" width="50%">
                <div id="output"><p>
                    Application messages appear here, latest first:
                </p></div>
            </td></tr>
        </table>
    </body>
</html>
